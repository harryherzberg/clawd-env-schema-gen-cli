#!/usr/bin/env node\nconst { Command } = require('commander');\nconst fs = require('fs');\n\nconst program = new Command();\nprogram\n  .name('clawd-env-schema-gen')\n  .description('Generate JSONSchema from .env.example')\n  .version('1.0.0');\n\nprogram.argument('[file]', '.env.example');\nprogram.option('-l, --license <key>', 'Pro license (PRO-XXXXXXXX)');\nprogram.option('-o, --output <file>', 'Output schema.json');\nprogram.option('--validator', 'Pro: generate ajv validator.js');\n\nprogram.action((file = '.env.example') => {\n  const content = fs.readFileSync(file, 'utf8');\n  const lines = content.split('\\n');\n  const properties = {};\n  const required = [];\n  lines.forEach(line => {\n    line = line.trim();\n    if (line && !line.startsWith('#')) {\n      const eqIdx = line.indexOf('=');\n      if (eqIdx !== -1) {\n        const key = line.slice(0, eqIdx).trim();\n        const val = line.slice(eqIdx + 1).trim();\n        const type = val === '' ? 'string' : (!isNaN(val) ? 'number' : (val === 'true' || val === 'false' ? 'boolean' : 'string'));\n        properties[key] = { type };\n        required.push(key);\n      }\n    }\n  });\n  const schema = {\n    \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n    type: 'object',\n    properties,\n    required\n  };\n  const opts = program.opts();\n  const outFile = opts.output || 'schema.json';\n  fs.writeFileSync(outFile, JSON.stringify(schema, null, 2));\n  console.log(`Schema saved to ${outFile}:`);\n  console.log(JSON.stringify(schema, null, 2));\n\n  const license = opts.license || process.env.CLAWD_LICENSE;\n  const isPro = !!license && /^PRO-[A-Z0-9]{8}$/.test(license);\n  if (opts.validator) {\n    if (!isPro) {\n      console.error('\\n‚ùå Pro feature: --validator requires valid --license PRO-XXXXXXXX');\n      console.log('\\nüí∞ Buy pro: https://your-gumroad.com/l/clawd-env-schema-gen');\n      process.exit(1);\n    }\n    const ajvCode = `// ajv validator.js (pro)\\nconst Ajv = require('ajv');\\nconst ajv = new Ajv();\\nconst validate = ajv.compile(${JSON.stringify(schema, null, 2)});\\nmodule.exports = validate;\\n\\n// Usage: const validate = require('./validator.js'); validate(envObj);`;\n    fs.writeFileSync('validator.js', ajvCode);\n    console.log('\\n‚úÖ Pro validator.js generated!');\n  }\n});\n\nprogram.parse();